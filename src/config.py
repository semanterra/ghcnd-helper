import polars as pl

pl.Config.set_float_precision(1)

ghcnh_filenames = [
    'ghcn-hourly_v1.0.0_d1790_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1791_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1796_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1797_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1798_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1799_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1800_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1801_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1802_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1803_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1804_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1805_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1806_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1807_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1808_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1809_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1810_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1811_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1812_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1813_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1814_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1815_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1816_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1817_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1818_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1819_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1820_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1821_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1822_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1823_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1824_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1825_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1826_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1827_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1828_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1829_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1830_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1831_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1832_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1833_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1834_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1835_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1836_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1837_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1838_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1839_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1840_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1841_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1842_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1843_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1844_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1845_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1846_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1847_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1848_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1849_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1850_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1851_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1852_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1853_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1854_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1855_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1856_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1857_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1858_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1859_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1860_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1861_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1862_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1863_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1864_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1865_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1866_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1867_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1868_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1869_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1870_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1871_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1872_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1873_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1874_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1875_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1876_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1877_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1878_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1879_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1880_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1881_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1882_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1883_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1884_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1885_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1886_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1887_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1888_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1889_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1890_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1891_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1892_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1893_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1894_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1895_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1896_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1897_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1898_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1899_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1900_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1901_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1902_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1903_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1904_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1905_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1906_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1907_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1908_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1909_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1910_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1911_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1912_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1913_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1914_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1915_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1916_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1917_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1918_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1919_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1920_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1921_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1922_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1923_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1924_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1925_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1926_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1927_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1928_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1929_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1930_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1931_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1932_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1933_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1934_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1935_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1936_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1937_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1938_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1939_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1940_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1941_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1942_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1943_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1944_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1945_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1946_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1947_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1948_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1949_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1950_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1951_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1952_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1953_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1954_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1955_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1956_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1957_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1958_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1959_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1960_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1961_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1962_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1963_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1964_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1965_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1966_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1967_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1968_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1969_c20240709-inv.tar.gz',

    'ghcn-hourly_v1.0.0_d1970_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1971_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1972_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1973_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1974_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1975_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1976_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1977_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1978_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1979_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1980_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1981_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1982_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1983_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1984_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1985_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1986_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1987_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1988_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1989_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1990_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1991_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1992_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1993_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1994_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1995_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1996_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1997_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1998_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d1999_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d2000_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d2001_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d2002_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d2003_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d2004_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d2005_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d2006_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d2007_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d2008_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d2009_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d2010_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d2011_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d2012_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d2013_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d2014_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d2015_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d2016_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d2017_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d2018_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d2019_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d2020_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d2021_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d2022_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d2023_c20240709-inv.tar.gz',
    'ghcn-hourly_v1.0.0_d2024_c20241210-inv.tar.gz'
    ]

ghcnh_year_to_filename_dict = {int(fn.split('_')[2][1:]):fn for fn in ghcnh_filenames}
_ghcnh_year_minmax =(min(ghcnh_year_to_filename_dict.keys()), max(ghcnh_year_to_filename_dict.keys()))
ghcnh_year_range = range(_ghcnh_year_minmax[0], _ghcnh_year_minmax[1] + 1)
ghcnh_local_path = '/Users/estaub/climatex/ghcnh/hourlyZips/20240709/'
ghcnh_local_doc_path = '/Users/estaub/ghcnh/doc/'
pressure_slice_path = '/Users/estaub/ghcnh/cache/pressure_slice/'
# warning using years before 1970 requires code changes to avoid Unix 1970 beginning of time
# warning 2024 observations are incomplete
pressure_year_ranges = (range(1970, 1975), range(2018, 2023))
